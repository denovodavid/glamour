(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{343:function(t,a,n){"use strict";n.r(a);var e=n(6),s=Object(e.a)({},(function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"main-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#main-loop"}},[t._v("#")]),t._v(" Main Loop")]),t._v(" "),n("h2",{attrs:{id:"initialising"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#initialising"}},[t._v("#")]),t._v(" Initialising")]),t._v(" "),n("p",[t._v("The "),n("code",[t._v("main")]),t._v(" function in Sandbox only contains 4 lines:")]),t._v(" "),n("div",{staticClass:"language-rs extra-class"},[n("pre",{pre:!0,attrs:{class:"language-rs"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fn")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function-definition function"}},[t._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("mut")]),t._v(" app "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token namespace"}},[t._v("glamour"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")])]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("App")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Glamour Sandbox"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1920")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1080")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" sandbox_layer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SandboxLayer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SandboxLayer"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("push_layer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Box")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("::")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("new")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sandbox_layer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    app"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("run")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("Calling "),n("code",[t._v("glamour::App::new(title: &str, width: u32, height: u32)")]),t._v(" will do the following:")]),t._v(" "),n("ul",[n("li",[t._v("Create a new event loop from the "),n("code",[t._v("glutin")]),t._v(" crate to handle OS I/O")]),t._v(" "),n("li",[t._v("Build a window with the supplied "),n("code",[t._v("title")]),t._v(", "),n("code",[t._v("width")]),t._v(", and "),n("code",[t._v("height")])]),t._v(" "),n("li",[t._v("Load OpenGL within that window's context")]),t._v(" "),n("li",[t._v("Load imgui")]),t._v(" "),n("li",[t._v("Initialise the Layer stack.")])]),t._v(" "),n("p",[t._v("After this point, layers can be pushed to the app, and then run.")]),t._v(" "),n("h2",{attrs:{id:"layer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#layer"}},[t._v("#")]),t._v(" Layer")]),t._v(" "),n("p",[t._v("A "),n("code",[t._v("Layer")]),t._v(" is a basic trait to handle events of distinct parts of the application. Layers don't communicate with each other through the app, they're meant to be separate. There are only two layers used in the app:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("PerfMetricsLayer")]),t._v(" for reporting performance metrics")]),t._v(" "),n("li",[n("code",[t._v("SandboxLayer")]),t._v(" is a place to store all Sandbox related things.")])]),t._v(" "),n("p",[n("code",[t._v("Layer")]),t._v(" provides a few funtions that an implementation can use:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("init()")])]),t._v(" "),n("li",[n("code",[t._v("on_event()")])]),t._v(" "),n("li",[n("code",[t._v("on_fixed_update()")])]),t._v(" "),n("li",[n("code",[t._v("on_frame_update()")])]),t._v(" "),n("li",[n("code",[t._v("on_imgui_update()")])])]),t._v(" "),n("p",[t._v("Hopfully, those should be fairly self documentating.")]),t._v(" "),n("h2",{attrs:{id:"event-loop"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#event-loop"}},[t._v("#")]),t._v(" Event Loop")]),t._v(" "),n("p",[t._v("Calling "),n("code",[t._v("app.run()")]),t._v(" kickstarts the main event loop, which is responsible for")]),t._v(" "),n("ul",[n("li",[t._v("Polling for events")]),t._v(" "),n("li",[t._v("Managing fixed and frame updates")]),t._v(" "),n("li",[t._v("Updating and rendering imgui")]),t._v(" "),n("li",[t._v("Calling the each layer's "),n("code",[t._v("Layer")]),t._v(" trait functions at the appropriate point")]),t._v(" "),n("li",[t._v("Swapping the frame buffer to actual show the rendered image on the screen.")])]),t._v(" "),n("h2",{attrs:{id:"appcontext"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#appcontext"}},[t._v("#")]),t._v(" AppContext")]),t._v(" "),n("p",[n("code",[t._v("App")]),t._v(" also maintains a struct that holds the context of the application. This is "),n("code",[t._v("AppContext")]),t._v(", it provides some convenience to access things such as the window context and frame timings. This is passed to each "),n("code",[t._v("Layer")]),t._v(" function.")])])}),[],!1,null,null,null);a.default=s.exports}}]);